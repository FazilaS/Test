---
title: "Remittances Sent to Pakistan Over Decades" 
author: "Fazila Sadia" 
date: today 
format:    
  html:     
    code-fold: true 
execute:   
  echo: false   
  warning: false

---

### Global Remittance Outlook 2022

Sending money back home is more than a simple financial transaction. It serves as a lifeline that connects families across borders, symbolizing love, sacrifice, and the unbreakable bond between migrants and their families. Remittances go beyond mere dollars and cents; they embody resilience, bridging the physical distance and nurturing hope for a better future.

In quotes:

Each remittance carries with it the stories of sacrifice, resilience, and determination of those who seek better opportunities afar, while nurturing the dreams and aspirations of loved ones left behind.



In the digital age, remittances serve as a vital artery in the global economy, pumping billions of dollars annually across borders.  @fig-global highlights this

```{r} 
#| label: fig-global 
#|fig-cap: "Global Remittance Trend"   

library(readxl) 
library(dplyr) 
library(lubridate) 
library(tidyverse) 
library(stringr) 
library(plotly) 
library(shiny) 
library(crosstalk)  

remit_inflow <-read_xlsx("./inflow.xlsx")  
df <- remit_inflow %>%   select(c(1,24)) %>%   
  rename(countries  = "Remittance inflows (US$ million)", inflow  = "2022") %>%   na.omit()%>%   
  arrange(desc(inflow))%>%   
  filter(!if_any(where(is.character),                                  ~ str_detect(.x, "World|Low-and Middle-Income Countries")))%>%   arrange(desc(inflow))%>%   
  slice(1:10)%>%   
  mutate(inflow = round(inflow / 1000, 2) )    

plot_ly(df, x = ~inflow, y = ~reorder(countries, inflow),          type = "bar")%>%   
  layout(title = "World's Top Remittance Recipients in 2022 ",          xaxis = list(title = "", showline = FALSE, showticklabels = FALSE),          
         yaxis = list(title = ""))%>% 
  add_annotations(text=~inflow,x = ~inflow+1.5,  
                  y = ~reorder(countries, inflow), 
                  font = list(family = 'Calibri', size = 15),
                  showarrow = FALSE)
```

### Asia Specific

-   As of 2022, the global remittance landscape witnessed a significant surge, with total remittances reaching a staggering *\[insert billion-dollar figure\]* USD, surpassing previous records.

-   Amidst the global flow of remittances, Asia emerges as a powerhouse, with five of the top 10 recipients hailing from this dynamic region. This statistical snapshot not only underscores Asia's economic centrality but also hints at the intricate web of financial exchanges crisscrossing the continent.

-   Among the top recipients of remittances, India emerged as the frontrunner, receiving a substantial influx of *\[insert billion-dollar figure\]* USD. (Highlight India and China stats then move to Pakistan\>\>\> can you add a map shading three countries and their percentage?)

-   India's robust economy and expansive diaspora contribute to its status as a remittance powerhouse, with billions flowing into the country annually. China, with its booming economic growth and large overseas population, commands a formidable position among the top recipients. However, as we shift our focus to Pakistan, we uncover a nuanced story of remittance flows shaped by unique socioeconomic dynamics and migration pattern. @fig-emmigration deaek

```{r}
#| label: fig-emmigration 
#| #| fig-cap: "Remittance Trend"  

install.packages("readxl") 
library("readxl") 
library(dplyr)  
data <- read_xls("./coutnry.xls")  
data <- data %>%   
  rename(countries = "...2", total = "...30") %>%   
  select(c("countries", "total")) %>%   
  mutate(total = as.numeric(total) ) %>%   
  filter(total > 200000  & total< 13438966)   
plot_ly(data, x = ~total,y = ~reorder(countries, total), type = 'bar',         orientation = "h",         hoverinfo = "text",         marker = list(color = ~countries)) %>%   
  layout(title = "Emigration by Country",          
         xaxis = list(title = "",showline = FALSE, showticklabels = FALSE),          
         yaxis = list(showgrid = FALSE,                              showline = FALSE, showticklabels = TRUE, title=""),          
         barmode = 'group',          showlegend = FALSE) %>%
  add_annotations(x = ~total *0.79+1 ,text = ~paste(round(total/100000, 2)),font = list(family = 'Arial', size = 15),showarrow = FALSE) %>%   
  config(displayModeBar = FALSE)  # Optional: Hide the plotly modebar  
```

## Paksitan's Trend Over the Decades

While Pakistan may not claim the top spots like its regional counterparts, its remittance receipts play a vital role in supporting millions of households and bolstering the national economy. Despite facing challenges such as geopolitical instability and economic uncertainties, Pakistan remains a key player in the global remittance arena. @fig-trend explores the trend of remittances sent to Pakistan

```{r}
#| label: fig-trend 
#| #| fig-cap: "Pakistan Remittance Trend Over Decades"  


library(lubridate) 
library(tidyverse) 
library(stringr) 
library(showtext)

############ typography #########3

font_add_google("Fraunces", "Fraunces")
font_add_google("Poppins", "poppins")
showtext_auto()

Fraunces <- "Fraunces"
poppins<- "poppins"


df <- read.csv("./dataset.csv") # Place your data transformation code here 
# Create a function to determine fiscal year based on given formula
get_fiscal_year <- function(date) {
  year <- as.integer(format(date, "%Y"))
  ifelse(month(date) >= 7, year + 1, year)
}

# Calculate fiscal year for each observation in the data frame
df$fiscal_year <- get_fiscal_year(as.Date(df$Observation.Date, format = "%d-%b-%Y"))

# Group by country and fiscal year, then calculate sum of remit values
result <- df %>%
  group_by(Series.Display.Name, fiscal_year) %>%
  summarise(remit = sum(Observation.Value)) %>%
  rename(country = Series.Display.Name,
         year = fiscal_year)%>%
  mutate(country = sub(".*?\\.?\\s+(\\b\\w+\\b)", "\\1", country))%>%
  filter(!str_detect(country, "Cash Flow|Other|Total|EU Countries|Encashment|Dubai|Sharjah|Abu Dhabi|Others"))%>%
  arrange(country)

df<- result

ggplot(df, aes(year, remit, group = country)) + 
  geom_hline(yintercept = seq(from = 0, to = 8000, by = 2000), col = "gray") +
  geom_line(data = subset(df, country %in% c("Saudi Arabia", "U.A.E.", "U.K.", "USA")), aes(color = country), size = 1.15) +
  geom_line(data = subset(df, !country %in% c("Saudi Arabia", "U.A.E.", "U.K.", "USA")), color = "gray", size = 1) +
  scale_color_manual(values = c("Saudi Arabia" = "#8FC48D", "U.A.E." = "#E1CA70", "U.K." = "#89BAF2", "USA" = "#F7A2D8")) +
  theme(legend.position = "none", 
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = '#F7F3EC', color = '#F6ECDF'),
        panel.border = element_blank(),
        axis.ticks.x=element_blank(),
        axis.ticks.y =element_blank(),
        plot.margin = margin(20, 20, 20, 20),
        plot.title = element_text(family = "Fraunces", face = 'bold',
                                  size = 20,color = "black",margin = margin(0, 0, 0, 0)),
        plot.subtitle = element_text(family = "poppins",
                                     size = 15,color = "black",margin = margin(10.5, 0, 10, 0)),
        axis.text.x = element_text(family = "poppins", face= "bold"),
        axis.text.y = element_text(family = "poppins", face = "bold"),
        plot.background = element_rect(fill = "white" )) +
  geom_text(data = df[df$country == "Saudi Arabia",], aes(x = 2018.7, y = 6600, label = "Saudi Arabia", angle=75), color = "#8FC48D", family= poppins, size = 5.2)  +
  geom_text(data = df[df$country == "U.A.E.",], aes(x = 2021, y = 5160, label = "UAE"), color = "#E1CA70",family= poppins, size = 5.2) +
  geom_text(data = df[df$country == "U.K.",], aes(x = 2022, y = 3895, label = "UK"), color = "#89BAF2",family= poppins, size = 5.2) +
  geom_text(data = df[df$country == "USA",], aes(x = 2002, y = 1600, label = "USA"), color = "#F7A2D8",family= poppins, size = 5.2)+
  scale_y_continuous(position = "right")+
  coord_cartesian(expand = FALSE)+
  labs(x = NULL, y = NULL ,title= "Pakistan Remittance Trend 1970 - 2023",
       subtitle = "Saudi Arabia and UAE are the largest remittance providers to Pakistan")


```
